<head>
  <%= stylesheet_link_tag 'show' %>
</head>

<div class="flex-container">
  <div class="listing">
    <div class="listing__header">
      <h1 class="listing__title"><%= @listing.title %></h1>
      <p class="listing__location"><%= @listing.title.split(", ").first %></p>
    </div>

    <% if @listing.photo.key? %>
      <%= cl_image_tag @listing.photo.key, width: 400, height: 300, crop: :lfill %>
    <% end %>

    <div class="listing__details">
      <p class="listing__address"><strong>Address:</strong> <%= @listing.address %></p>
      <p class="listing__price"><strong>Price:</strong> <%= number_to_currency(@listing.price_per_day) %> per day</p>
      <p class="listing__user"><strong>Contact:</strong> <%= @listing.user.email %></p>
    </div>

    <div class="listing__description">
      <p><%= @listing.description %></p>
    </div>

    <div class="listing__actions">
      <%= link_to 'Edit', listing_edit_path(@listing), class: 'button button--edit' %>
      <%= link_to 'Delete', listing_path(@listing), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"}, class: 'button button--delete' %>
    </div>
  </div>
  <div class="listing booking-card">
    <%= link_to 'Request Booking',  bookings_path(@listing) %>
      <% if current_user.id == @listing.user_id %><%= link_to 'See Bookings',  all_bookings_path(@listing) %><% end %>
      <p>You won't be charged now</p>
  </div>
</div>



<div style="width: 50%; height: 400px;"
      data-controller="map"
      data-map-markers-value="<%= @markers.to_json %>"
      data-map-center-value="<%= @center.to_json %>"
      data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>"></div>
